<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>canon²</title>

<style>
@font-face {
  font-family: 'MyriadPro';
  src: url('/fonts/converted/MyriadPro-Regular.woff2') format('woff2'),
       url('/fonts/converted/MyriadPro-Regular.woff') format('woff');
}

body {
  margin: 0;
  font-family: 'MyriadPro', sans-serif;
  background: #f3f3f3;
  color: #f78c20;
}
@media (prefers-color-scheme: dark) {
  body {
    background: #2e2e2e;
    color: #f0b6e7;
  }
}

/* ---------- Gallery ---------- */
.gallery {
  column-count: 4;
  column-gap: 10px;
  padding: 12px;
}
@media (max-width: 1100px) { .gallery { column-count: 3; } }
@media (max-width: 700px)  { .gallery { column-count: 2; } }
@media (max-width: 480px)  { .gallery { column-count: 1; } }

.gallery img {
  width: 100%;
  margin-bottom: 10px;
  cursor: pointer;
}

/* ---------- Lightbox ---------- */
.lightbox {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.92);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 999;
}
.lightbox img {
  max-width: 92vw;
  max-height: 92vh;
}

/* ---------- Desktop arrows ---------- */
.nav-btn {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  font-size: 48px;
  color: #fff;
  cursor: pointer;
}
#prevBtn { left: 20px; }
#nextBtn { right: 20px; }

@media (max-width: 768px) {
  .nav-btn { display: none; }
}

/* ---------- Info panel ---------- */
.info-panel {
  position: absolute;
  right: 24px;
  bottom: 96px;
  background: rgba(0,0,0,0.7);
  color: #fff;
  padding: 16px;
  font-size: 14px;
  display: none;
  max-width: 260px;
}

/* ---------- Desktop bottom UI ---------- */
.desktop-ui {
  position: absolute;
  bottom: 64px;
  right: 24px;
  display: flex;
  gap: 12px;
}
.desktop-ui button,
.desktop-ui span {
  background: rgba(0,0,0,0.6);
  color: #fff;
  border: none;
  padding: 8px 12px;
  font-size: 14px;
  cursor: pointer;
}

@media (max-width: 768px) {
  .desktop-ui { display: none; }
}

/* ---------- Mobile bottom bar ---------- */
.mobile-bar {
  display: none;
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 56px;
  background: rgba(0,0,0,0.55);
  backdrop-filter: blur(6px);
  align-items: center;
  justify-content: space-between;
  padding: 0 16px;
}

.mobile-bar button,
.mobile-bar span {
  color: #fff;
  background: none;
  border: none;
  font-size: 16px;
  cursor: pointer;
}

@media (max-width: 768px) {
  .mobile-bar { display: flex; }
}
</style>
</head>

<body>

<div class="gallery" id="gallery"></div>

<div class="lightbox" id="lightbox">
  <img id="lightboxImg">

  <!-- Desktop arrows -->
  <div id="prevBtn" class="nav-btn">⟨</div>
  <div id="nextBtn" class="nav-btn">⟩</div>

  <!-- Desktop UI -->
  <div class="desktop-ui">
    <span id="counterDesktop"></span>
    <button id="infoBtnDesktop">INFO</button>
  </div>

  <!-- Info panel -->
  <div class="info-panel" id="infoPanel"></div>

  <!-- Mobile bar -->
  <div class="mobile-bar">
    <button id="mobilePrev">⟨</button>
    <span id="counterMobile"></span>
    <button id="infoBtnMobile">INFO</button>
    <button id="mobileNext">⟩</button>
  </div>
</div>

<script>
let photos = [];
let index = 0;
let infoVisible = false;

fetch("photos/photos.json")
  .then(r => r.json())
  .then(data => {
    photos = data;
    const g = document.getElementById("gallery");

    data.forEach((p, i) => {
      const img = document.createElement("img");
      img.src = "photos/thumbs/" + p.FileName.replace(/\.jpg$/i, ".webp");
      img.onerror = () => img.src = "photos/thumbs/" + p.FileName;
      img.onclick = () => openLightbox(i);
      g.appendChild(img);
    });
  });

function openLightbox(i) {
  index = i;
  document.getElementById("lightbox").style.display = "flex";
  document.getElementById("lightboxImg").src = "photos/full/" + photos[i].FileName;
  updateUI();
}

function updateUI() {
  document.getElementById("counterDesktop").textContent = `(${index+1}/${photos.length})`;
  document.getElementById("counterMobile").textContent  = `(${index+1}/${photos.length})`;

  if (infoVisible) {
    const p = photos[index];
    document.getElementById("infoPanel").innerHTML = `
      <div><strong>Camera</strong>: ${p.Model || "—"}</div>
      <div><strong>Lens</strong>: ${p.LensModel || "—"}</div>
      <div><strong>Date</strong>: ${p.DateTimeOriginal || "—"}</div>
      <div><strong>ISO</strong>: ${p.ISO || "—"}</div>
      <div><strong>Aperture</strong>: f/${p.Aperture || "—"}</div>
      <div><strong>Shutter</strong>: ${p.ShutterSpeed || "—"}</div>
      <div><strong>Film</strong>: ${p.Film || "—"}</div>
    `;
    document.getElementById("infoPanel").style.display = "block";
  }
}

function toggleInfo() {
  infoVisible = !infoVisible;
  document.getElementById("infoPanel").style.display = infoVisible ? "block" : "none";
  updateUI();
}

infoBtnDesktop.onclick = toggleInfo;
infoBtnMobile.onclick = toggleInfo;

prevBtn.onclick = () => index > 0 && openLightbox(index - 1);
nextBtn.onclick = () => index < photos.length - 1 && openLightbox(index + 1);
mobilePrev.onclick = prevBtn.onclick;
mobileNext.onclick = nextBtn.onclick;

document.getElementById("lightbox").onclick = e => {
  if (e.target.id === "lightbox") {
    document.getElementById("lightbox").style.display = "none";
    infoVisible = false;
    document.getElementById("infoPanel").style.display = "none";
  }
};

document.addEventListener("keydown", e => {
  if (lightbox.style.display !== "flex") return;
  if (e.key === "ArrowRight" && index < photos.length - 1) openLightbox(index + 1);
  if (e.key === "ArrowLeft" && index > 0) openLightbox(index - 1);
  if (e.key === "Escape") lightbox.style.display = "none";
});
</script>

</body>
</html>
